apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: server-image-pv-claim
  labels:
    app: imagehost
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1000Gi
---
apiVersion: v1
kind: Service
metadata:
  name: imagehost
  labels:
    app: imagehost
spec:
  type: NodePort
  ports:
    - port: 3000
  selector:
    app: imagehost
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: imagehost
spec:
  replicas: 1
  selector:
    matchLabels:
      app: imagehost
  template:
    metadata:
      labels:
        app: imagehost

    spec:
      containers:
      - name: imagehost
        image: ghcr.io/john2143/john2143.com:9
        imagePullPolicy: Always

        ports:
        - containerPort: 3000

        volumeMounts:
        - mountPath: /app/juushFiles
          name: data-volume

        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 100m
            memory: 128Mi

      volumes:
      - name: data-volume
        emptyDir:
          sizeLimit: 100Mi
        #persistentVolumeClaim:
          #claimName: server-image-pv-claim
